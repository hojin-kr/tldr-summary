<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
  <link href="{{ url_for('static', path='/styles.css') }}" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <link rel=â€shortcut iconâ€ href=â€static/favicon.icoâ€>
  <title id="title" class="locale title"></title>
</head>
<body>
    <img id="icon" src="https://storage.googleapis.com/url-358416.appspot.com/static/url-icon.png" alt="none img">
    <H3 id="h1" class="locale h1"></H3>
    <p id="h2" class="locale h2"></p>
    <p id="h3" class="locale h3"></p>
    <br>
    <div id="create">
        <label for="input" class="locale label-input"></label>
        <textarea id="input" class="locale input input-warp" name="" cols="30" rows="10"></textarea>
        <div id="summary-grade">
            <button id="grade-1" class="btn-grade locale btn-grade-1 btn-selected" value="1"></button>
            <button id="grade-3" class="btn-grade locale btn-grade-3" value="3"></button>
            <button id="grade-10" class="btn-grade locale btn-grade-10" value="10"></button>
            <button id="grade-30" class="btn-grade locale btn-grade-30" value="30"></button>
        </div>
        <button id="btn-input" class="locale btn-input btn-full-large"></button>
    </div>
    <div id="result">
        <label for="output" class="locale label-output"></label>
        <textarea id="output" class="locale input input-warp" name="" cols="30" rows="10"></textarea>
        <button id="btn-copy" class="locale btn-copy btn-full-large"></button>
        <button id="btn-copied" class="locale btn-copied btn-full-large"></button>
    </div>
    <footer>
        Mailbox: jhj377@gmail.com
    </footer>
</body>
</html>

<script>

    let Domain = window.location.protocol + "//" + window.location.hostname

    let ContryCode = "KR"
    let now = new Date()
    let page = 0
    let grade = 1

    let locales = {
        "US":{
            "title":"TL;DR : summarizing",
            "h1":"TL; DR",
            "h2":"Too Long; Didn't Read",
            "h3":"Share as you want, summarizing, and meaningful.",
            "input":"Orion has an advanced guidance, navigation, and control (GN&C) system, responsible for always knowing where the spacecraft is located in space, which way itâ€™s pointed, and where itâ€™s going. It primarily uses two star trackers, sensitive cameras that take pictures of the star field around Orion, the Moon, and Earth, and compares the pictures to its built-in map of stars. The Optical navigation camera is a secondary camera that takes images of the Moon and Earth to help orient the spacecraft by looking at the size and position of the celestial bodies in the image. At several times during the mission, the optical navigation camera will be tested to certify it for use on future flights. Once certified, the camera also can help Orion autonomously return home if it were to lose communication with Earth. (https://www.nasa.gov/feature/additional-artemis-i-test-objectives-to-provide-added-confidence-in-capabilities-0)",
            "source":"The Optical navigation camera is a secondary camera that takes images of the Moon and Earth to help orient the spacecraft by looking at the size and position of the celestial bodies in the image",
            "btn-input":"Summarize ðŸ‘",
            "btn-copy":"to copy",
            "btn-copied":"Copied, paste wherever you want",
            "article-title-0":"How to use",
            "article-desc-0":"",
            "article-title-1":"Title",
            "article-desc-1":"Desc",
            "label-input":"Too Long; Didn't Read.",
            "label-source":"Cool story, bro",
            "label-output":"Summary",
            "label-preview":"Preview ðŸ‘€",
            "how-title":"How to use ðŸŽ‰",
            "how-desc-0":"Step1. paste long link",
            "how-desc-1":"Step2. create custom links",
            "how-desc-2":"Step3. Preview ðŸ‘€ & cut down ðŸ‘",
            "how-desc-3":"Step4. Share your link anywhere ðŸ”—",
            "benefit-title":"Advantages",
            "benefit-desc-0":"random character ðŸ™†ðŸ»â€â™‚ï¸ custom link ðŸ™†â€â™€ï¸",
            "benefit-desc-1":"Totally free, service fee Zero ðŸ’¸",
            "benefit-desc-2":"Unlimited Link Creation, Unlimited Traffic ðŸ“ˆ",
            "article-title":"Usage example",
            "article-more":"More",
            "btn-share":"Share",
            "alert-link-check":"Watch your link",
            "already-use":"already used",
            "more-last":"Last news. thank you :)",
            "ad-cs-title":"Advertisement",
            "ad-cs-desc":"place your ad on this site : jhj377@gmail.com",
            "too-short-text": "This article is not suitable for summarizing.",
            "btn-grade-1":"1 lines",
            "btn-grade-3":"3 lines",
            "btn-grade-10":"10 lines",
            "btn-grade-30":"30 lines",
        },
        'KR':{
            "title":"TL;DR : ì§§ê²Œ ìš”ì•½í•´ì„œ!",
            "h1":"TL; DR",
            "h2":"Too Long; Didn't Read",
            "h3":"ê¸´ ê¸€ì„ ì§§ê²Œ ìš”ì•½í•´ì„œ ê³µìœ í•˜ì„¸ìš”!",
            "input":"ë°˜ë©´, ì• í”Œì€ ê´‘ê³  ì •ì±… ë³€ë™ì˜ ì˜í–¥ìœ¼ë¡œ ìžì²´ ê´‘ê³  ì‚¬ì—…ì´ ì´ì „ë³´ë‹¤ í¬ê²Œ ì„±ìž¥í•˜ê³  ìžˆì–´ìš”. ì• í”Œì´ ê°€ìž¥ í° ìˆ˜í˜œìžê°€ ë  ê²ƒì´ë¼ëŠ” ì´ˆê¸° ì˜ˆì¸¡ì´ ë§žì€ ê±°ì£ . ì• í”Œì˜ 2021ë…„ ê´‘ê³  ì‚¬ì—… ë§¤ì¶œì€ 2020ë…„ ëŒ€ë¹„ 238% ì¦ê°€í•œ 37ì–µ ë‹¬ëŸ¬(4ì¡° 4115ì–µ ì›)ì„ ê¸°ë¡í–ˆì–´ìš”. ê·¸ì¤‘ì—ì„œë„ ì„œì¹˜ê´‘ê³  ë¶€ë¬¸ì€ ì „ë…„ ëŒ€ë¹„ 264% ì¦ê°€í•œ 35ì–µ ë‹¬ëŸ¬(4ì¡° 1737ì–µ ì›)ì˜ ë§¤ì¶œì„ ë‹¬ì„±í–ˆê³ ìš”. ì„œì¹˜ ì• ë“œ(Search Ads)ëž€ ì•±ìŠ¤í† ì–´ì—ì„œ ì‚¬ìš©ìžê°€ Aë¼ëŠ” ì•±ì„ ê²€ìƒ‰í–ˆì„ ë•Œ, ê´€ë ¨ë„ ë†’ì€ ê´‘ê³ ì£¼ì˜ Bì•±ì„ ìµœìƒë‹¨ì— ë…¸ì¶œí•´ì£¼ëŠ” ë°©ì‹ì¸ë°ìš”. 2020ë…„ 10ì›” ê¸°ì¤€ 17%ì— ë¶ˆê³¼í–ˆë˜ ì„œì¹˜ ì• ë“œì˜ ì•„ì´í° ì•± ë‹¤ìš´ë¡œë“œ ì ìœ ìœ¨ì´ 1ë…„ ë’¤ì¸ 2021ë…„ 10ì›”(ì¦‰, ATT ì¡°ì¹˜ê°€ ì‹œí–‰ë˜ê³  6ê°œì›” ë’¤)ì—ëŠ” 58%ê¹Œì§€ ë†’ì•„ì§„ ê²ƒìœ¼ë¡œ í™•ì¸ëì–´ìš”. ì•žìœ¼ë¡œ ê´‘ê³  ì‹œìž¥ì—ì„œ ì• í”Œì˜ ì„œì¹˜ ì• ë“œë¥¼ ì´ìš©í•˜ë ¤ëŠ” íë¦„ì€ ì ì  ì»¤ì§ˆ ê²ƒ ê°™ê³ ìš”.(ì›ë¬¸ : https://blog.toss.im/article/global-business-lounge-13)",
            "source":"ì• í”Œì˜ 2021ë…„ ê´‘ê³  ì‚¬ì—… ë§¤ì¶œì€ 2020ë…„ ëŒ€ë¹„ 238% ì¦ê°€í•œ 37ì–µ ë‹¬ëŸ¬(4ì¡° 4115ì–µ ì›)ì„ ê¸°ë¡í–ˆì–´ìš”",
            "btn-input":"ì¤„ì´ê¸° ðŸ‘",
            "btn-copy":"ë³µì‚¬í•˜ê¸°",
            "btn-copied":"ë³µì‚¬ë¨, ì›í•˜ëŠ”ê³³ì— ë¶™ì—¬ ë„£ìœ¼ì„¸ìš”",
            "article-title-0":"How to use",
            "article-desc-0":"",
            "article-title-1":"Title",
            "article-desc-1":"Desc",
            "label-input":"ê¸´ ê¸€",
            "label-source":"ì»¤ìŠ¤í…€ ë§í¬",
            "label-output":"ìš”ì•½",
            "label-preview":"ë§í¬ ë¯¸ë¦¬ë³´ê¸° ðŸ‘€",
            "how-title":"ì´ìš© ë°©ë²• ðŸŽ‰",
            "how-desc-0":"Step1. ê¸´ ë§í¬ë¥¼ ë¶™ì—¬ë„£ê¸°",
            "how-desc-1":"Step2. ì»¤ìŠ¤í…€ ë§í¬ë¥¼ ìž‘ì„±",
            "how-desc-2":"Step3. ë¯¸ë¦¬ë³´ê¸° ðŸ‘€ & ì¤„ì´ê¸° ðŸ‘",
            "how-desc-3":"Step4. ë§í¬ë¥¼ ì–´ë””ë“  ê³µìœ í•˜ì„¸ìš” ðŸ”—",
            "benefit-title":"ìž¥ì ",
            "benefit-desc-0":"ëžœë¤ ë¬¸ìž ðŸ™†ðŸ»â€â™‚ï¸ ì»¤ìŠ¤í…€ ë§í¬ ðŸ™†â€â™€ï¸",
            "benefit-desc-1":"ì™„ì „ ë¬´ë£Œ, ì„œë¹„ìŠ¤ ì´ìš©ë£Œ Zero ðŸ’¸",
            "benefit-desc-2":"ì œí•œ ì—†ëŠ” ë§í¬ ìƒì„±, ë¬´ì œí•œ íŠ¸ëž˜í”½ ðŸ“ˆ",
            "article-title":"ì´ìš© ì˜ˆì‹œ",
            "article-more":"ë” ë³´ê¸°",
            "btn-share":"ê³µìœ í•˜ê¸°",
            "alert-link-check":"ë§í¬ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”",
            "already-use":"ì´ë¯¸ ì‚¬ìš©ì¤‘ì¸ ë§í¬",
            "more-last":"ë§ˆì§€ë§‰ ë‰´ìŠ¤ìž…ë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤ :)",
            "ad-cs-title":"ê´‘ê³ ",
            "ad-cs-desc":"ê´‘ê³  ë¬¸ì˜ : jhj377@gmail.com",
            "too-short-text":"ìš”ì•½í•˜ê¸°ì— ì í•©í•˜ì§€ ì•Šì€ ê¸€ìž…ë‹ˆë‹¤",
            "btn-grade-1":"1ì¤„",
            "btn-grade-3":"3ì¤„",
            "btn-grade-10":"10ì¤„",
            "btn-grade-30":"30ì¤„",
        },
    }


    init()

    function init() {
        $("#result").hide()
        $("#btn-copied").hide()
        locale()
    }

    function locale() {
        getStaticText(ContryCode)
        $.ajax({
        method: "GET",
        url: "https://api.ip.pe.kr/json",
        })
        .done(function( msg ) {
            if (msg.country_code != undefined && msg.country_code == "US") {
                ContryCode = "US"
                getStaticText(ContryCode)
            }
        })
    }

  $(document).on("click", ".btn-share", (event)=>{
    $(event.target).prev().select();
    document.execCommand( 'Copy' );
    alert(locales[ContryCode]["btn-copied"])
  });

  // btn copy
  $("#btn-copy").on("click", ()=>{
    $("#output").select();
    document.execCommand( 'Copy' );
    $("#btn-copy").hide()
    $("#btn-copied").show()
  })

  $("#btn-copied").on("click", ()=>{
    $("#output").select();
    document.execCommand( 'Copy' );
  })

  $("#source").on("keyup", ()=>{
    $("#preview").val(Domain+"/"+$("#source").val())
  })

  $("#btn-random").on("click", ()=>{
    setRandString()
  })

  function setRandString() {
    $("#source").val(generateRandomString(5))
    $("#preview").val(Domain+"/"+$("#source").val())
  }

  // validater URL
  function validaterURL(source, input) {
    if (input == "") {
        alert(locales[ContryCode]["alert-link-check"])
        return false
    }
    if (source == "") {
        setRandString()
    }
    return true
  }

  function createURL(source, input) {
    if (!validaterURL(source, input)) {
        return 1;
    }
    // force https
    input = input.replace(/http:\/\//g, "https://")
    // attach https
    if (input.substr(0, 8) != "https://") {
        input = "https://" + input
    }
    // escape space
    source = source.replace(/ /g, "%20")
    $.ajax({
        method: "POST",
        url: "https://tl-dr.in",
        data: { source: source, input: input }
    })
    .done(function( msg ) {
        if (msg == 500) {
            alert(locales[ContryCode]["already-use"])
            return 1
        }
        // build result URL
        resultURL = Domain+"/"+source
        // replace space escape
        resultURL = resultURL.replace(/\%20/g, " ")
        $("#output").val(resultURL)
        showResult()
    })
  }

  function showResult() {
    $("#create").hide()
    $("#result").show()
  }

  const generateRandomString = (num) => {
  const characters ='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890_-';
  let result = '';
  const charactersLength = characters.length;
  for (let i = 0; i < num; i++) {
      result += characters.charAt(Math.floor(Math.random() * charactersLength));
  }

  return result;
}

  function getStaticText(countryCode = "KR") {
    $(".locale.title").text(locales[countryCode]["title"])
    $(".locale.h1").text(locales[countryCode]["h1"])
    $(".locale.h2").text(locales[countryCode]["h2"])
    $(".locale.h3").text(locales[countryCode]["h3"])
    $(".locale.input").attr("placeholder",locales[countryCode]["input"])
    $(".locale.source").attr("placeholder",locales[countryCode]["source"])
    $(".locale.btn-input").text(locales[countryCode]["btn-input"])
    $(".locale.btn-copy").text(locales[countryCode]["btn-copy"])
    $(".locale.btn-copied").text(locales[countryCode]["btn-copied"])
    $(".locale.label-input").text(locales[countryCode]["label-input"])
    $(".locale.label-source").text(locales[countryCode]["label-source"])
    $(".locale.label-output").text(locales[countryCode]["label-output"])
    $(".locale.label-preview").text(locales[countryCode]["label-preview"])
    $("#preview").val(Domain+"/"+locales[countryCode]["source"])
    $(".locale.how-title").text(locales[countryCode]["how-title"])
    $(".locale.how-desc-0").text(locales[countryCode]["how-desc-0"])
    $(".locale.how-desc-1").text(locales[countryCode]["how-desc-1"])
    $(".locale.how-desc-2").text(locales[countryCode]["how-desc-2"])
    $(".locale.how-desc-3").text(locales[countryCode]["how-desc-3"])
    $(".locale.benefit-title").text(locales[countryCode]["benefit-title"])
    $(".locale.benefit-desc-0").text(locales[countryCode]["benefit-desc-0"])
    $(".locale.benefit-desc-1").text(locales[countryCode]["benefit-desc-1"])
    $(".locale.benefit-desc-2").text(locales[countryCode]["benefit-desc-2"])
    $(".locale.article-title").text(locales[countryCode]["article-title"])
    $(".locale.article-more").text(locales[countryCode]["article-more"])
    $(".locale.btn-share").text(locales[countryCode]["btn-share"])
    $(".locale.ad-cs-title").text(locales[countryCode]["ad-cs-title"])
    $(".locale.ad-cs-desc").text(locales[countryCode]["ad-cs-desc"])
    $(".locale.btn-grade-1").text(locales[countryCode]["btn-grade-1"])
    $(".locale.btn-grade-3").text(locales[countryCode]["btn-grade-3"])
    $(".locale.btn-grade-10").text(locales[countryCode]["btn-grade-10"])
    $(".locale.btn-grade-30").text(locales[countryCode]["btn-grade-30"])
  }

  $(".btn-grade").on("click", (event)=>{
    $(".btn-grade").removeClass("btn-selected")
    $(event.target).addClass("btn-selected")
    grade = $(event.target).attr("value")
  })

  $("#btn-input").on("click", ()=>{
        let input = $("#input").val()
        let _grade = grade
        let output = ""
        let data = JSON.stringify({ input: input, output: output, grade: _grade })
        $.ajax({
            method: "PUT",
            url: "summary",
            dataType: "json",
            contentType: "application/json",
            data: data,
            })
            .done(function( msg ) {
                console.log(msg)
                let output = msg.output
                if (output == "") {
                    output = msg.input
                    alert(locales[ContryCode]['too-short-text'])
                }
                $("#output").val(output)
                showResult()
            })
            .fail((msg)=>{
                console.log(msg)
            })
    })

</script>
